<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>UBC Stat406 2023W - Guide for setting up the course infrastructure</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title"><i class="fa-solid fa-chart-column" aria-label="chart-column"></i> UBC Stat406</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./syllabus.html" rel="" target="">
 <span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./schedule/index.html" rel="" target="">
 <span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://ubc-stat.github.io/stat-406-worksheets/" rel="" target="">
 <span class="menu-text">Worksheets</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./computing/index.html" rel="" target="">
 <span class="menu-text">Computing</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://ubc-stat.github.io/stat-406-rpackage/" rel="" target="">
 <span class="menu-text">{Rpkg} Docs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./faq.html" rel="" target="">
 <span class="menu-text">FAQ</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/stat-406-2023" rel="" target="">
 <span class="menu-text"><i class="fa-brands fa-github" aria-label="github"></i> Github</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#github-org" id="toc-github-org" class="nav-link active" data-scroll-target="#github-org">Github Org</a>
  <ul class="collapse">
  <li><a href="#create-a-github.com-organization" id="toc-create-a-github.com-organization" class="nav-link" data-scroll-target="#create-a-github.com-organization">Create a GitHub.com organization</a>
  <ul class="collapse">
  <li><a href="#permissions-and-structure" id="toc-permissions-and-structure" class="nav-link" data-scroll-target="#permissions-and-structure">Permissions and structure</a></li>
  <li><a href="#teams" id="toc-teams" class="nav-link" data-scroll-target="#teams">Teams</a></li>
  </ul></li>
  <li><a href="#repos" id="toc-repos" class="nav-link" data-scroll-target="#repos">Repos</a>
  <ul class="collapse">
  <li><a href="#homeworks" id="toc-homeworks" class="nav-link" data-scroll-target="#homeworks">Homeworks</a></li>
  <li><a href="#labs" id="toc-labs" class="nav-link" data-scroll-target="#labs">Labs</a></li>
  <li><a href="#clicker-solutions" id="toc-clicker-solutions" class="nav-link" data-scroll-target="#clicker-solutions">clicker-solutions</a></li>
  <li><a href="#practice-final" id="toc-practice-final" class="nav-link" data-scroll-target="#practice-final">practice-final</a></li>
  <li><a href="#open-pr-log" id="toc-open-pr-log" class="nav-link" data-scroll-target="#open-pr-log">open-pr-log</a></li>
  <li><a href="#github-.github-private" id="toc-github-.github-private" class="nav-link" data-scroll-target="#github-.github-private"><code>.github</code> / <code>.github-private</code></a></li>
  <li><a href="#bakeoff-bakeoff" id="toc-bakeoff-bakeoff" class="nav-link" data-scroll-target="#bakeoff-bakeoff"><code>bakeoff-bakeoff</code></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#r-package" id="toc-r-package" class="nav-link" data-scroll-target="#r-package">R package</a></li>
  <li><a href="#worksheets" id="toc-worksheets" class="nav-link" data-scroll-target="#worksheets">Worksheets</a></li>
  <li><a href="#course-website-lectures" id="toc-course-website-lectures" class="nav-link" data-scroll-target="#course-website-lectures">Course website / lectures</a></li>
  <li><a href="#ghclass-package" id="toc-ghclass-package" class="nav-link" data-scroll-target="#ghclass-package"><code>{ghclass}</code> package</a></li>
  <li><a href="#canvas" id="toc-canvas" class="nav-link" data-scroll-target="#canvas">Canvas</a></li>
  <li><a href="#slack" id="toc-slack" class="nav-link" data-scroll-target="#slack">Slack</a></li>
  <li><a href="#clickers" id="toc-clickers" class="nav-link" data-scroll-target="#clickers">Clickers</a></li>
  <li><a href="#before-day-1" id="toc-before-day-1" class="nav-link" data-scroll-target="#before-day-1">Before Day 1</a></li>
  <li><a href="#populate-the-org" id="toc-populate-the-org" class="nav-link" data-scroll-target="#populate-the-org">Populate the Org</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/ubc-stat/stat-406/blob/main/course-setup.qmd" class="toc-action">View source</a></p><p><a href="https://github.com/ubc-stat/stat-406/issues/new/" class="toc-action">Report an issue</a></p><p><a href="https://github.com/ubc-stat/stat-406/edit/main/course-setup.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Guide for setting up the course infrastructure</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><em>Version 2023</em></p>
<p>This guide (hopefully) gives enough instructions for recreating new iterations of Stat 406.</p>
<section id="github-org" class="level1">
<h1>Github Org</h1>
<section id="create-a-github.com-organization" class="level2">
<h2 class="anchored" data-anchor-id="create-a-github.com-organization">Create a GitHub.com organization</h2>
<ul>
<li>This is free for faculty with instructor credentials.</li>
<li>Allows more comprehensive GitHub actions, PR templates and CODEOWNER behaviour than the UBC Enterprise version (last I checked)</li>
<li>Downside is getting students added (though we include R scripts for this)</li>
</ul>
<p>Once done, go to <a href="https://github.com/watching" class="uri">https://github.com/watching</a>. Click the Red Down arrow “Unwatch all”. Then select this Org. The TAs should do the same.</p>
<section id="permissions-and-structure" class="level3">
<h3 class="anchored" data-anchor-id="permissions-and-structure">Permissions and structure</h3>
<p>Settings &gt; Member Privileges</p>
<p>We list only the important ones.</p>
<ul>
<li>Base Permissions: No Permission</li>
<li>Repository creation: None</li>
<li>Repo forking: None</li>
<li>Pages creation: None</li>
<li>Team creation rules: No</li>
</ul>
<p>Be sure to click save in each area after making changes.</p>
<p>Settings &gt; Actions &gt; General</p>
<p>All repositories: Allow all actions and reusable workflows.</p>
<p>Workflow permissions: Read and write permissions.</p>
</section>
<section id="teams" class="level3">
<h3 class="anchored" data-anchor-id="teams">Teams</h3>
<ul>
<li>2 teams, one for the TAs and one for the students</li>
<li>You must then manually add the teams to any repos they should access</li>
</ul>
<p>I generally give the TAs “Write” permission, and the students “Read” permission with some exceptions. See the Repos section below.</p>
</section>
</section>
<section id="repos" class="level2">
<h2 class="anchored" data-anchor-id="repos">Repos</h2>
<p>There are typically about 10 repositories. Homeworks and Labs each have 3 with very similar behaviours.</p>
<p>Be careful copying directories. All of them have hidden files and folders, e.g. <code>.git</code>. Of particular importance are the <code>.github</code> directories which contain PR templates and GitHub Actions. Also relevant are the <code>.Rprofile</code> files which try to override Student Language settings and avoid unprintible markdown characters.</p>
<section id="homeworks" class="level3">
<h3 class="anchored" data-anchor-id="homeworks">Homeworks</h3>
<section id="homework-solutions" class="level4">
<h4 class="anchored" data-anchor-id="homework-solutions">homework-solutions</h4>
<p>This is where most of the work happens. My practice is to create the homework solutions first. I edit these (before school starts) until I’m happy. I then duplicate the file and remove the answers. The result is <code>hwxx-instructions.Rmd</code>. The <code>.gitignore</code> file should ignore all of the solutions and commit only the instructions. Then, about 1 week after the deadline, I adjust the <code>.gitignore</code> and push the solution files.</p>
<ul>
<li>Students have Read permission.</li>
<li>TAs have Write permission.</li>
<li>The <code>preamble.tex</code> file is common to HWs and Labs. It creates a lavender box where the solution will go. This makes life easy for the TAs.</li>
</ul>
</section>
<section id="homework-solutions-private" class="level4">
<h4 class="anchored" data-anchor-id="homework-solutions-private">homework-solutions-private</h4>
<p>Exactly the same as <code>homework-solutions</code> except that all solutions are available from the beginning for TA access. To create this, after I’m satisfied with <code>homework-solutions</code> I copy all files (not the directory) into a new directory, <code>git init</code> then upload to the org. The students never have permission here.</p>
</section>
<section id="homework-template" class="level4">
<h4 class="anchored" data-anchor-id="homework-template">homework-template</h4>
<p>This is a “template repo” used for creating student specific <code>homework-studentgh</code> repos (using the setup scripts).</p>
<p><em>Very Important</em>: copy the <code>hwxx-instructions</code> files over to a new directory. Do NOT copy the directory or you’ll end up with the solutions visible to the students.</p>
<p>Then rename <code>hwxx-instructions.Rmd</code> to <code>hwxx.Rmd</code>. Now the students have a <code>.pdf</code> with instructions, and a template <code>.Rmd</code> to work on.</p>
<p>Other important tasks: * The <code>.gitignore</code> is more elaborate in an attempt to avoid students pushing junk into these repos. * The <code>.github</code> directory contains 3 files: - <code>CODEOWNERS</code> begins as an empty doc which will be populated with the assigned grader later; - <code>pull_request_template.md</code> is used for all HW submission PRs; - <code>workflows</code> contains a GH-action to comment on the PR with the date+time when the PR is opened. * Under Settings &gt; General, select “Template repository”. This makes it easier to duplicate to the student repos.</p>
</section>
</section>
<section id="labs" class="level3">
<h3 class="anchored" data-anchor-id="labs">Labs</h3>
<p>The three Labs repos operate exactly as the analogous homework repos.</p>
<section id="labs-solutions" class="level4">
<h4 class="anchored" data-anchor-id="labs-solutions">labs-solutions</h4>
<p>Do any edits here before class begins.</p>
</section>
<section id="labs-solutions-private" class="level4">
<h4 class="anchored" data-anchor-id="labs-solutions-private">labs-solutions-private</h4>
<p>Same as with the homeworks</p>
</section>
<section id="labs-template" class="level4">
<h4 class="anchored" data-anchor-id="labs-template">labs-template</h4>
<p>Same as with the homeworks</p>
</section>
</section>
<section id="clicker-solutions" class="level3">
<h3 class="anchored" data-anchor-id="clicker-solutions">clicker-solutions</h3>
<p>This contains the complete set of clicker questions.</p>
<p>Answers are hidden in comments on the presentation.</p>
<p>I release them incrementally after each module (copying over from my clicker deck).</p>
</section>
<section id="practice-final" class="level3">
<h3 class="anchored" data-anchor-id="practice-final">practice-final</h3>
<p>Contains a length practice exam as well as solutions. I usually only post this during the last week of class.</p>
</section>
<section id="open-pr-log" class="level3">
<h3 class="anchored" data-anchor-id="open-pr-log">open-pr-log</h3>
<p>This contains a some GitHub actions to automatically keep track of open PRs for the TAs.</p>
<p>It’s still in testing phase, but should work properly. It will create two markdown docs, 1 for labs and 1 for homework. Each shows the assigned TA, the date the PR was opened, and a link to the PR. If everything is configured properly, it should run automatically at 3am every night.</p>
<ul>
<li>Only the TAs should have access.</li>
<li>Under Settings &gt; Secrets and Variables &gt; Actions you must add a “Repository Secret”. This should be a GitHub Personal Access Token created in your account (Settings &gt; Developer settings &gt; Tokens (classic)). It needs Repo, Workflow, and Admin:Org permissions. I set it to expire at the end of the course. I use it only for this purpose (rather than my other tokens for typical logins).</li>
</ul>
</section>
<section id="github-.github-private" class="level3">
<h3 class="anchored" data-anchor-id="github-.github-private"><code>.github</code> / <code>.github-private</code></h3>
<p>These contains a README that gives some basic information about the available repos and the course.</p>
<p>It’s visible Publically, and appears on the Org homepage for all to see. The <code>.github-private</code> has the same function, but applies only to Org members.</p>
</section>
<section id="bakeoff-bakeoff" class="level3">
<h3 class="anchored" data-anchor-id="bakeoff-bakeoff"><code>bakeoff-bakeoff</code></h3>
<p>This is for the bonus for HW4. Both TAs and Students have access. I put the TA team as CODEOWNERS and protect the <code>main</code> branch (Settings &gt; Branches &gt; Branch Protection Rules). Here, we “Require approvals” and “Require Review from Code Owners”.</p>
</section>
</section>
</section>
<section id="r-package" class="level1">
<h1>R package</h1>
<p>This is hosted at <a href="https://github.com/ubc-stat/stat-406-rpackage/" class="uri">https://github.com/ubc-stat/stat-406-rpackage/</a>. The main purposes are:</p>
<ol type="1">
<li>Documentation of datasets used in class, homework, and labs (if not in other R packages)</li>
<li>Provide a few useful functions.</li>
<li>Install all the packages the students need at once, and try to compile LaTeX.</li>
</ol>
<p>Package requirements are done manually, unfortunately. Typically, I’ll open the various projects in RStudio and run <code>sort(unique(renv::dependencies()$Package))</code>. It’s not infallible, but works well.</p>
<p>All necessary packages should go in “Suggests:” in the <code>DESCRIPTION</code>. This avoids build errors. Note that install via <code>remotes::install_github()</code> then requires <code>dependencies = TRUE</code>.</p>
</section>
<section id="worksheets" class="level1">
<h1>Worksheets</h1>
<p>These are derived from Matías’s Rmd notes from 2018. They haven’t been updated much.</p>
<p>They are hosted at <a href="https://github.com/ubc-stat/stat-406-worksheets/" class="uri">https://github.com/ubc-stat/stat-406-worksheets/</a>.</p>
<p>I tried requiring them one year. The model was to distribute the R code for the chapters with some random lines removed. Then the students could submit the completed code for small amounts of credit. It didn’t seem to move the needle much and was hard to grade (autograding would be nice here).</p>
<p>Note that there is a GHaction that automatically renders the book from source and pushes to the <code>gh-pages</code> branch. So local build isn’t necessary and derivative files should not be checked in to version control.</p>
</section>
<section id="course-website-lectures" class="level1">
<h1>Course website / lectures</h1>
<p>This is hosted at <a href="https://github.com/ubc-stat/stat-406" class="uri">https://github.com/ubc-stat/stat-406</a>.</p>
<p>The entire site and all slides are <code>.qmd</code> files. It’s configured following the instructions at <a href="https://quarto.org/docs/publishing/github-pages.html#publish-action" class="uri">https://quarto.org/docs/publishing/github-pages.html#publish-action</a>. This means that the site is automatically built and pushed to the <code>gh-pages</code> branch when the <code>main</code> branch is updated. But all <code>R</code> computations must be done <em>locally</em> first (because <code>execute: freeze: auto</code>). This avoids the need for <code>renv</code> configuration for the GHaction. So you should render the entire site locally before committing / pushing.</p>
<p>Some notes:</p>
<ul>
<li><code>_quarto.yml</code> contains the configuration for the site.</li>
<li><code>_metadata.yml</code> contains configuration for the slides.</li>
<li>Installing the course package should install all necessary packages. But some may be missing.</li>
</ul>
</section>
<section id="ghclass-package" class="level1">
<h1><code>{ghclass}</code> package</h1>
<p>I have my own fork of Colin Rundel’s <code>{ghclass}</code> package <a href="https://github.com/dajmcdon/ghclass" class="uri">https://github.com/dajmcdon/ghclass</a>. This is mainly because we need to be able to create repos and apply various branch protections and PR review requirements. I’ve added a few other things, but nothing major (and some no longer useful). The version numbering is different from Colin’s to reflect the changes.</p>
<p>Interaction with this package usually involves the course roster, so none of it is under version control (to avoid possible contamination).</p>
</section>
<section id="canvas" class="level1">
<h1>Canvas</h1>
<p>I use the shell provided by FoS.</p>
<p>Nothing else goes here, but you have to update all the links.</p>
<p>Two or three Canvas Quizzes:</p>
<ul>
<li>Quiz 0 collects GitHub accounts, ensures that students read the syllabus. Due in Week 1.</li>
<li>Final Exam is the final</li>
<li>(optional) Midterm Survey. Sometimes ASDa does this, sometimes I do it.</li>
<li>I usually record lectures (automatically) using the classroom tech that automatically uploads.</li>
<li>Update the various links on the Homepage.</li>
</ul>
</section>
<section id="slack" class="level1">
<h1>Slack</h1>
<ul>
<li>Set up a free Org. Invite link gets posted to Canvas.</li>
<li>I add <code>@students.ubc.ca</code>, <code>@ubc.ca</code>, <code>@stat.ubc.ca</code> to the whitelist.</li>
<li>I also post the invite on Canvas.</li>
<li>Create channels before people join. That way you can automatically add everyone to channels all at once. I do one for each module, 1 for code/github, 1 for mechanics. + 1 for the TAs (private)</li>
<li>Click through all the settings. It’s useful to adjust these a bit.</li>
<li>I find it helpful to block posting in #general. So announcements can go there.</li>
<li>Once a Module is complete, I would like to archive the relevant channel. The goal being to avoid posting to the wrong place. However, then the students won’t know how to find it. A tradeoff I haven’t solved.</li>
</ul>
</section>
<section id="clickers" class="level1">
<h1>Clickers</h1>
<p>See <a href="https://lthub.ubc.ca/guides/iclicker-cloud-instructor-guide/" class="uri">https://lthub.ubc.ca/guides/iclicker-cloud-instructor-guide/</a></p>
<p>I only use “Polling” no “Quizzing” and no “Attendance”</p>
<ul>
<li>In clicker Settings &gt; Polling &gt; Sharing. Turn off the Sending (to avoid students doing it at home)</li>
<li>No participation points.</li>
<li>2 points for correct, 2 for answering.</li>
<li>Integrations &gt; Set this up with Canvas. Sync the roster. You’ll likely have to repeat this near the Add/Drop Deadline.</li>
<li>I only sync the total, since I’ll recalibrate later.</li>
</ul>
</section>
<section id="before-day-1" class="level1">
<h1>Before Day 1</h1>
<ul>
<li>Ensure the above are all created.</li>
<li>Create a <code>labs-yourusername</code> from the <code>labs-template</code> repo (for the Version Control Lecture)</li>
<li>Double check links on the Canvas site (including the Slack invite)</li>
<li>Deal with any Canvas announcements</li>
<li>Add “notes” to the Canvas gradebook. This is a good place to put the ghusername: Grades &gt; Gear (settings) &gt; View Options &gt; Notes.</li>
</ul>
</section>
<section id="populate-the-org" class="level1">
<h1>Populate the Org</h1>
<p>Once students start taking the quiz, use the scripts in <code>gh-class-management</code> to begin</p>
<ol type="1">
<li>Inviting students to GitHub (they must accept the invitation). Announce this!!!</li>
<li>Adding those that accept to the “students” team.</li>
</ol>
<p>The responses can be downloaded in a .csv at Quizzes &gt; Lab 0 &gt; Survey Statistics &gt; Student Analysis.</p>
<p>The rest is a bit manual. I do multiple rounds. And sometimes have to filter out junk responses.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">This work by <a href="https://dajmcdon.github.io">Daniel J. McDonald</a> is licensed under <a href="https://creativecommons.org/licenses/by-nc/4.0">CC BY-NC 4.0</a><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1"></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>